// Generated by CoffeeScript 1.4.0
(function() {
  var Calculator, DelimiterController;

  Calculator = (function() {

    function Calculator() {}

    Calculator.inputError = new TypeError("negative numbers are not allowed");

    Calculator.delimiter;

    Calculator.numbers_string;

    Calculator.prototype.add = function(numbers_string) {
      var delimiterController;
      this.numbers_string = numbers_string;
      if (this.numbers_string === "") {
        return 0;
      }
      delimiterController = new DelimiterController(this.numbers_string);
      this.delimiter = delimiterController.parseDelimiter();
      this.numbers_string = delimiterController.numbers;
      return this.sumArray(this.splitIntoArray());
    };

    Calculator.prototype.splitIntoArray = function(numbers_string) {
      return this.numbers_string.split(RegExp("\\n|" + this.delimiter));
    };

    Calculator.prototype.sumArray = function(numbers) {
      var num, sum, _i, _len;
      sum = 0;
      for (_i = 0, _len = numbers.length; _i < _len; _i++) {
        num = numbers[_i];
        sum += parseInt(num);
        if (parseInt(num) < 0) {
          this.rejectNegatives();
        }
      }
      return sum;
    };

    Calculator.prototype.rejectNegatives = function() {
      throw this.inputError;
    };

    return Calculator;

  })();

  DelimiterController = (function() {

    DelimiterController.delimiter;

    DelimiterController.numbers;

    function DelimiterController(numbers_string) {
      this.numbers = numbers_string;
    }

    DelimiterController.prototype.parseDelimiter = function() {
      var match;
      match = this.numbers.match(/\/\/(.+?)\n(.*)/);
      if (match) {
        this.numbers = match[2];
        this.delimiter = match[1];
      } else {
        this.delimiter = ",";
      }
      return this.delimiter;
    };

    DelimiterController.prototype.numbers = function() {
      return this.numbers;
    };

    return DelimiterController;

  })();

  module.exports = Calculator;

}).call(this);
