// Generated by CoffeeScript 1.7.1
(function() {
  var Calculator, NaturalNumber, Parser;

  Calculator = (function() {
    function Calculator() {}

    Calculator.prototype.add = function(numbers_string) {
      if (numbers_string === "") {
        return 0;
      }
      return new Parser(numbers_string).coerce(NaturalNumber.parse).reduce(this.sum, 0);
    };

    Calculator.prototype.sum = function(acc, num) {
      return acc + num;
    };

    return Calculator;

  })();

  NaturalNumber = (function() {
    function NaturalNumber() {}

    NaturalNumber.inputError = new TypeError("negative numbers are not allowed");

    NaturalNumber.parse = function(value) {
      var number;
      number = parseInt(value);
      if (number < 0) {
        throw this.inputError;
      }
      return number;
    };

    return NaturalNumber;

  })();

  Parser = (function() {
    Parser.prototype.delimiter = ",";

    function Parser(string) {
      this.string = string;
    }

    Parser.prototype.coerce = function(func) {
      this.parse();
      return this.toArray().map(func);
    };

    Parser.prototype.toArray = function() {
      return this.string.split(RegExp("\\n|" + this.delimiter));
    };

    Parser.prototype.parse = function() {
      var match, _ref;
      if (match = this.string.match(/\/\/(.+?)\n(.*)/)) {
        _ref = [match[2], match[1]], this.string = _ref[0], this.delimiter = _ref[1];
      }
      return this;
    };

    return Parser;

  })();

  module.exports = Calculator;

}).call(this);
